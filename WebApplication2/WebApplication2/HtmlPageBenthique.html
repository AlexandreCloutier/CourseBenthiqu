<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

</head>
<body onload="startGame()">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
    <script>
        //Paquet de carte principal.
        var paquetCarte;
        //Tableau contenant les mains.
        var mains;

        //Tableau contenant toute les cartes du bas de chaque joueur.
        var carteBas;

        //Numero du joueur présentement actif.
        var numeroJoueurActif;

        //Variable comptant le nombre de tour *TEMPORAIRE POUR L'INSTANT* mais on va l'utiliser pour vrai plus tard.
        var tour = 0;

        //Variable content le nb de clic sur le bouton Passer son tour
        var facteurRotation = 0;

        //Fonction appeler au début, elle "start" le jeu.
        function startGame() {
            carteBas = new Array();
            creerFond();
            ajouterEmplacementHabitatBas();
            ajouterEmplacementCarteBas();
            paquetCarte = creerPaquetCarte(1);
            melangerPaquetCarte(paquetCarte);
            creerMain();
            creerPartieDroite();

            /////////////NEW 4 joueurs //////////////////////////////////
            instantierTableauJoueur();
            remplirMain();
            numeroJoueurActif = 0;

            updateJeu();
        }

        //Fonction qui va instantier les différents tableau de tableau pour chaque jouer.
        function instantierTableauJoueur() {

            mains = new Array(4);
            mains[0] = new Array(6);
            mains[1] = new Array(6);
            mains[2] = new Array(6);
            mains[3] = new Array(6);

            //TODO: faire pareil pour les emplacements du bas..
        }

        //Fonction qui vérifie si le macroInvertebre ou le salmonide est jouable.
        function verifierCondition(carte) {
            if (carte.condition.length === 1) {
                var condition1 = carte.condition[0];

                for (var i = 0; i < carteBas.length; i++) {
                    if (carteBas[i] != null) {// Si il y a une carte.
                        if (carteBas[i].type === 'habitats' || carteBas[i].type === 'intervention') {// Si la carte est une habitats.
                            if (carteBas[i].habitats === condition1) {//Si l'habitats de la carte est la meme que la condition.
                                return true;
                            }
                        }
                    }
                }
            }
            else if (carte.condition.length === 2) {
                var condition1 = carte.condition[0];
                var condition2 = carte.condition[1];

                for (var i = 0; i < carteBas.length; i++) {
                    if (carteBas[i] != null) {// Si il y a une carte.
                        if (carteBas[i].type === 'habitats' || carteBas[i].type === 'intervention') {// Si la carte est une habitats.
                            if (carteBas[i].habitats === condition1) {//Si l'habitats de la carte est la meme que la condition1.
                                condition1 = 'ok';
                            }
                            else if (carteBas[i].habitats === condition2) {//Si l'habitats de la carte est la meme que la condition2.
                                condition2 = 'ok';
                            }
                        }
                    }
                }

                if (condition1 === 'ok' && condition2 === 'ok') {
                    return true;
                }
            }
            else if (carte.condition.length === 3) {
                var condition1 = carte.condition[0];
                var condition2 = carte.condition[1];
                var condition3 = carte.condition[2];

                for (var i = 0; i < carteBas.length; i++) {
                    if (carteBas[i] != null) {// Si il y a une carte.
                        if (carteBas[i].type === 'habitats' || carteBas[i].type === 'intervention') {// Si la carte est une habitats.
                            if (carteBas[i].habitats === condition1) {//Si l'habitats de la carte est la meme que la condition1.
                                condition1 = 'ok';
                            }
                            else if (carteBas[i].habitats === condition2) {//Si l'habitats de la carte est la meme que la condition2.
                                condition2 = 'ok';
                            }
                            else if (carteBas[i].habitats === condition3) {//Si l'habitats de la carte est la meme que la condition3.
                                condition3 = 'ok';
                            }
                        }
                    }
                }

                if (condition1 === 'ok' && condition2 === 'ok' && condition3 === 'ok') {
                    return true;
                }
            }
            else if (carte.condition.length === 4) {
                var condition1 = carte.condition[0];
                var condition2 = carte.condition[1];
                var condition3 = carte.condition[2];
                var condition4 = carte.condition[3];

                for (var i = 0; i < carteBas.length; i++) {
                    if (carteBas[i] != null) {// Si il y a une carte.
                        if (carteBas[i].type === 'habitats' || carteBas[i].type === 'intervention') {// Si la carte est une habitats.
                            if (carteBas[i].habitats === condition1) {//Si l'habitats de la carte est la meme que la condition1.
                                condition1 = 'ok';
                            }
                            else if (carteBas[i].habitats === condition2) {//Si l'habitats de la carte est la meme que la condition2.
                                condition2 = 'ok';
                            }
                            else if (carteBas[i].habitats === condition3) {//Si l'habitats de la carte est la meme que la condition3.
                                condition3 = 'ok';
                            }
                            else if (carteBas[i].habitats === condition4) {//Si l'habitats de la carte est la meme que la condition4.
                                condition4 = 'ok';
                            }
                        }
                    }
                }

                if (condition1 === 'ok' && condition2 === 'ok' && condition3 === 'ok' && condition4 === 'ok') {
                    return true;
                }
            }
            else {
                return false;
            }
        }

        //Fonction qui sera fréquement appeler pour ré-emplir la main
        function remplirMain() {
            if (tour === 0) {//Avant de commencer, remplie toutes les mains.
                //Première carte c'est un habitats rapides.
                mains[0][0] = chercherCarteParticuliere('rapides', paquetCarte);
                mains[1][0] = chercherCarteParticuliere('rapides', paquetCarte);
                mains[2][0] = chercherCarteParticuliere('rapides', paquetCarte);
                mains[3][0] = chercherCarteParticuliere('rapides', paquetCarte);

                //Deuxième carte c'est un habitats au hasard.
                mains[0][1] = chercherCarteParticuliere(habitatsHasard(), paquetCarte);
                mains[1][1] = chercherCarteParticuliere(habitatsHasard(), paquetCarte);
                mains[2][1] = chercherCarteParticuliere(habitatsHasard(), paquetCarte);
                mains[3][1] = chercherCarteParticuliere(habitatsHasard(), paquetCarte);

                //3e carte
                mains[0][2] = pigerCarte(paquetCarte);
                mains[1][2] = pigerCarte(paquetCarte);
                mains[2][2] = pigerCarte(paquetCarte);
                mains[3][2] = pigerCarte(paquetCarte);

                //4e carte
                mains[0][3] = pigerCarte(paquetCarte);
                mains[1][3] = pigerCarte(paquetCarte);
                mains[2][3] = pigerCarte(paquetCarte);
                mains[3][3] = pigerCarte(paquetCarte);

                //5e carte
                mains[0][4] = pigerCarte(paquetCarte);
                
                mains[1][4] = pigerCarte(paquetCarte);
                mains[2][4] = pigerCarte(paquetCarte);
                mains[3][4] = pigerCarte(paquetCarte);

                //6e carte
                mains[0][5] = pigerCarte(paquetCarte);
                mains[1][5] = pigerCarte(paquetCarte);
                mains[2][5] = pigerCarte(paquetCarte);
                mains[3][5] = pigerCarte(paquetCarte);
            }
            else {
                //Boucle pour toute les position de la main.
                for (var i = 0; i < 6; i++) {
                    if (mains[numeroJoueurActif, i] === null) {
                        mains[numeroJoueurActif, i] = pigerCarte(paquetCarte);
                    }
                }
            }
        }

        //Fonction qui renvoie une string d'un habitats au hasard pour permettre qu'on aille la chercher au début de la partie.
        function habitatsHasard() {
            var habitatsRetourner;//Habitats qui sera retourner.

            //Variable qui contiendra le nombres de chaque habitats qui sont présentement dans le paquet de carte.
            var nombreHabitats = 0;
            var nombreFosse = 0;
            var nombreRapides = 0;
            var nombreSable = 0;
            var nombreGravier = 0;
            var nombreGalets = 0;

            for (var i = 0; i < paquetCarte.length ; i++) {
                if (paquetCarte[i].nom === 'fosse') {
                    nombreFosse++;
                    nombreHabitats++;
                }
                else if (paquetCarte[i].nom === 'sable') {
                    nombreSable++;
                    nombreHabitats++;
                }
                else if (paquetCarte[i].nom === 'gravier') {
                    nombreGravier++;
                    nombreHabitats++;
                }
                else if (paquetCarte[i].nom === 'rapides') {
                    nombreRapides++;
                    nombreHabitats++;
                }
                else if (paquetCarte[i].nom === 'galets') {
                    nombreGalets++;
                    nombreHabitats++;
                }
            }

            //math.random qui décidera qu'elle habitats on retourne. Elle envoie un chiffre au hasard entre 1 et le nombre d'habitats.
            var nombreHasard;
            nombreHasard = Math.floor((Math.random() * nombreHabitats) + 1);

            //Tout les if pour savoir c'est qu'elle habitats, Toujours plus petit que l'habitats et plus grand que l'ancien habitats.
            if (nombreHasard <= nombreFosse) {
                habitatsRetourner = 'fosse';
            }
            else if (nombreHasard <= nombreFosse + nombreSable && nombreHasard > nombreFosse) {
                habitatsRetourner = 'sable';
            }
            else if (nombreHasard <= nombreFosse + nombreSable + nombreGravier && nombreHasard > nombreFosse + nombreSable) {
                habitatsRetourner = 'gravier';
            }
            else if (nombreHasard <= nombreFosse + nombreSable + nombreGravier + nombreRapides && nombreHasard > nombreFosse + nombreSable + nombreGravier) {
                habitatsRetourner = 'rapides';
            }
            else if (nombreHasard <= nombreFosse + nombreSable + nombreGravier + nombreRapides + nombreGalets && nombreHasard > nombreFosse + nombreSable + nombreGravier + nombreRapides) {
                habitatsRetourner = 'galets';
            }

            return habitatsRetourner;
        }

        //Fonction qui permet de chercher une carte en particulier.
        function chercherCarteParticuliere(nomCarte) {
            var carteRetours

            //Boucle dans tout le paquet de cartes à la recherche de la bonne carte.
            for (var i = 0; i < paquetCarte.length + 1; i++) {
                if (paquetCarte[i].nom === nomCarte) {
                    carteRetour = paquetCarte[i];

                    //Code qui change la valeur i avec la première valeur pour pouvoir faire un array.shift().
                    var valeurEnregistrer = paquetCarte[0];
                    paquetCarte[0] = paquetCarte[i];
                    paquetCarte[i] = valeurEnregistrer;


                    //Retire la carte sur le dessus
                    paquetCarte.shift();

                    //Re-mélange le paquet de carte puisqu'on viens d'enlever une carte particuliere en plein millieu.
                    melangerPaquetCarte(paquetCarte);
                    return carteRetour;
                }
            }
        }

        //Fonction qui ajoute la partie de droite.
        function creerPartieDroite() {
            var divNomJoueurs = document.createElement('div');
            divNomJoueurs.id = 'divNomJoueurs';
            divNomJoueurs.className = 'divNomJoueurs';
            divNomJoueurs.innerHTML = '<p class=titreEquipe><strong>Nom des équipes</strong></p><ul class=listeUlEquipe><li class=listeEquipe>Équipe A: Toto</li><li class=listeEquipe>Équipe B: Tata</li><li class=listeEquipe>Équipe C: Tyty</li><li class=listeEquipe>Équipe D: Tutu</li></ul>';
            document.getElementById('divDroite').appendChild(divNomJoueurs);


            var divTextePointsRessource = document.createElement('div');
            divTextePointsRessource.id = 'divTextePointsRessource';
            divTextePointsRessource.className = 'divTextePointsRessource';
            divTextePointsRessource.innerHTML = '<p class=titreRessource><strong>Points de ressources disponible : 6</strong>';
            document.getElementById('divDroite').appendChild(divTextePointsRessource);

            var divTextePointsJoueurs = document.createElement('div');
            divTextePointsJoueurs.id = 'divTextePointsJoueurs';
            divTextePointsJoueurs.className = 'divTextePointsJoueurs';
            divTextePointsJoueurs.innerHTML = '<p class=titreEquipe><strong>Points</strong></p><ul class=listeUlEquipe><li class=listeEquipe>Équipe A: 100</li><li class=listeEquipe>Équipe B: 100</li><li class=listeEquipe>Équipe C: 100</li><li class=listeEquipe>Équipe D: 100</li></ul>';
            document.getElementById('divDroite').appendChild(divTextePointsJoueurs);

            var divTexteMessageJeu = document.createElement('div');
            divTexteMessageJeu.id = 'divTexteMessageJeu';
            divTexteMessageJeu.className = 'divTexteMessageJeu';
            divTexteMessageJeu.innerHTML = '<p class=titreMessage><strong>Messages:</strong><textarea readonly class=zoneMessage>Ceci est une test</textarea>';
            divTexteMessageJeu.style.width = 280 + 'px';
            document.getElementById('divDroite').appendChild(divTexteMessageJeu);

            var buttonPasserTour = document.createElement('button');
            buttonPasserTour.id = 'buttonPasserTour';
            buttonPasserTour.className = 'buttonPasserTour';
            buttonPasserTour.setAttribute('onclick', 'passerTour()');
            buttonPasserTour.textContent = 'Passer son tour';
            document.getElementById('divDroite').appendChild(buttonPasserTour);

            var buttonProposerEchange = document.createElement('button');
            buttonProposerEchange.id = 'buttonProposerEchange';
            buttonProposerEchange.className = 'buttonProposerEchange';
            buttonProposerEchange.textContent = 'Proposer un échange.';
            document.getElementById('divDroite').appendChild(buttonProposerEchange);

            var buttonOption = document.createElement('button');
            buttonOption.id = 'buttonOption';
            buttonOption.className = 'buttonOption';
            buttonOption.textContent = 'Options';
            document.getElementById('divDroite').appendChild(buttonOption);
        }

        //Fonction qui ajoute une div avec le plateau en fond d'écran.
        function creerFond() {
            //Partie de gauche.
            var divMain = document.createElement('div');
            divMain.id = 'divMain';
            divMain.className = 'divMain';
            document.getElementsByTagName('body')[0].appendChild(divMain);

            //Partie du millieu.
            var plateau = document.createElement('div');
            plateau.id = 'plateau';
            plateau.className = 'plateau';
            document.getElementsByTagName('body')[0].appendChild(plateau);

            //Partie de droite.
            var divDroite = document.createElement('div');
            divDroite.id = 'divDroite';
            divDroite.className = 'divDroite';
            document.getElementsByTagName('body')[0].appendChild(divDroite);
        }

        //Fonction qui ajoute 6 emplacement d'habitats dans le bas.
        function ajouterEmplacementHabitatBas() {
            //Boucle 6 fois pour ajouter les 6 emplacements D'habitats du bas.
            var id;
            for (id = 1; id < 7; id++) {
                var divEmplacementHabitat = document.createElement('div');
                divEmplacementHabitat.id = 'divEmplacementHabitatBas' + id;
                divEmplacementHabitat.className = 'divEmplacementHabitatBas';
                divEmplacementHabitat.style.left = 117 + 66 * id + 'px';
                document.getElementById('plateau').appendChild(divEmplacementHabitat);
                $(function () {
                    $('.divEmplacementHabitatBas').droppable({
                        drop: function (event, ui) {
                            ui.draggable.css('width', '58px');
                            ui.draggable.css('height', '90px');
                            ui.draggable.appendTo(this);
                            ui.draggable.draggable('disable');
                            ui.draggable.position({ of: $(this), my: 'center', at: 'center' });
                            if ($(this).children().length > 1) {
                                ui.draggable.css('margin-top', ($(this).children().length * 10) - 10 + 'px');
                            }
                        }
                    });
                });
            }
        }

        //Fonction qui ajoute 4 emplacement de carte sur les emplacements d'habitats du bas.
        function ajouterEmplacementCarteBas() {
            //Boucle 4 fois pour ajouter les 4 emplacements sur les emplacements D'habitats du bas.
            var id;
            for (id = 1; id < 5; id++) {
                var divEmplacementCarte = document.createElement('div');
                divEmplacementCarte.id = 'divEmplacementCarteBas' + id;
                divEmplacementCarte.className = 'divEmplacementCarteBas';
                divEmplacementCarte.style.left = 182 + 66 * id + 'px';
                document.getElementById('plateau').appendChild(divEmplacementCarte);
                $(function () {
                    $('.divEmplacementCarteBas').droppable({
                        drop: function (event, ui) {
                            ui.draggable.css('width', '58px');
                            ui.draggable.css('height', '90px');
                            ui.draggable.appendTo(this);
                            ui.draggable.draggable('disable');
                            ui.draggable.position({ of: $(this), my: 'center', at: 'center' });
                            if ($(this).children().length > 1) {
                                ui.draggable.css('margin-top', ($(this).children().length * 10) - 10 + 'px');
                            }
                        }
                    });
                });
            }
        }

        function creerMain() {
            var id;
            for (id = 0; id < 6; id++) {
                var li = document.createElement('li');
                li.className = 'liMain';
                li.id = 'liMain' + id;
                document.getElementById('divMain').appendChild(li);

                var divCarte = document.createElement('div');
                divCarte.id = 'divCarte' + id;
                divCarte.className = 'divCarte';
                li.appendChild(divCarte);

                //var image = document.createElement('img');
                //image.className = 'imageCarte';
                //image.src = 'resources/CarteEau.png';
                //// Mes image Dans le idiv
                //divCarte.appendChild(image);

                //$(function () {
                //    $('.imageCarte').draggable({ revert: 'invalid', cursorAt: { top: 90, left: 59 } });
                //});
            }
        }

        //Définition de la classe.
        function Carte(type, nom, nomImage, coutResources, params) {
            if (type === 'habitats') {
                this.nom = nom;
                this.type = type;
                this.habitats = params.habitats;
                this.coutResources = coutResources;
                this.nomImage = nomImage;
            }
            else if (type === 'salmonide') {
                this.nom = nom;
                this.type = type;
                this.coutResources = coutResources;
                this.condition = params.condition;
                this.nomImage = nomImage;
            }
            else if (type === 'bandeRiveraine') {
                this.nom = nom;
                this.type = type;
                this.coutResources = coutResources;
                this.nomImage = nomImage;
            }
            else if (type === 'speciale') {
                this.nom = nom;
                this.type = type;
                this.nomImage = nomImage;
                this.coutResources = coutResources;
            }
            else if (type === 'speciale') {
                this.nom = nom;
                this.type = type;
                this.nomImage = nomImage;
                this.coutResources = coutResources;
            }
            else if (type === 'action') {
                this.nom = nom;
                this.type = type;
                this.nomImage = nomImage;
                this.coutResources = coutResources;
            }
            else if (type === 'perturbation') {
                this.nom = nom;
                this.type = type;
                this.nomImage = nomImage;
                this.coutResources = coutResources;
                this.tempsActif = params.tempsActif;
            }
            else if (type === 'reglementation') {
                this.nom = nom;
                this.type = type;
                this.nomImage = nomImage;
                this.coutResources = coutResources;
            }
            else if (type === 'macroInvertebre') {
                this.nom = nom;
                this.type = type;
                this.nomImage = nomImage;
                this.coutResources = coutResources;
                this.tolerance = params.tolerance;
                this.taille = params.taille;
                this.predateur = params.predateur;
                this.typeMacro = params.typeMacro;
                this.condition = params.condition;
            }
            else if (type === 'bandeRiveraine') {
                this.nom = nom;
                this.type = type;
                this.nomImage = nomImage;
                this.coutResources = coutResources;
            }
            else if (type === 'intervention') {
                this.nom = nom;
                this.type = type;
                this.nomImage = nomImage;
                this.coutResources = coutResources;
            }
        }

        //function pour piger une carte.
        function pigerCarte(paquetCarte) {
            return paquetCarte.pop();
        }

        //Function qui melange le paquet de carte.
        function melangerPaquetCarte(paquetCarte) {
            var currentIndex = paquetCarte.length, temporaryValue, randomIndex;

            // While there remain elements to shuffle...
            while (0 !== currentIndex) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                temporaryValue = paquetCarte[currentIndex];
                paquetCarte[currentIndex] = paquetCarte[randomIndex];
                paquetCarte[randomIndex] = temporaryValue;
            }
        }

        //function qui crée le paquet de carte.
        function creerPaquetCarte(difficulte) {
            var carte;
            var paquetCarte = new Array();

            //Dépendant du niveau de la partie, il n'y aura pas les mêmes cartes  dans le deck.
            //if (tour == 1) {
            //----------------------------------habitats-----------------------------------

            carte = new Carte('habitats', 'fosse', 'fosse.png', 1, { habitats: 'fosse' });
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            carte = new Carte('habitats', 'sable', 'sable.png', 1, { habitats: 'sable' });
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            carte = new Carte('habitats', 'gravier', 'gravier.png', 2, { habitats: 'gravier' });
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            carte = new Carte('habitats', 'rapides', 'rapides.png', 3, { habitats: 'rapides' });
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            carte = new Carte('habitats', 'galets', 'galets.png', 3, { habitats: 'galets' });
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            // ----------------------------MacroInvertebre--------------------------------------------------

            carte = new Carte('macroInvertebre', 'oligochaeta', 'oligochaeta.png', 1, { tolerance: 8, taille: 1, typeMacro: 'amelide', condition: [''], predateur: 0 });
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            carte = new Carte('macroInvertebre', 'simuliidae', 'simuliidae.png', 1, { tolerance: 6, taille: 2, typeMacro: 'diptere', condition: ['rapides', 'galets'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'chironomidae', 'chironomidae.png', 1, { tolerance: 8, taille: 2, typeMacro: 'diptere', condition: [''], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'psephenidae', 'psephenidae.png', 2, { tolerance: 3, taille: 4, typeMacro: 'coleoptere', condition: ['rapides', 'galets'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'hydropsychidae', 'hydropsychidae.png', 2, { tolerance: 5, taille: 4, typeMacro: 'trichoptere', condition: ['rapides'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'elmidae', 'elmidae.png', 2, { tolerance: 3, taille: 3, typeMacro: 'coleoptere', condition: ['rapides'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'baetidae', 'baetidae.png', 2, { tolerance: 5, taille: 3, typeMacro: 'ephemeroptere', condition: ['rapides'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'hydroptilidae', 'hydroptilidae.png', 2, { tolerance: 4, taille: 2, typeMacro: 'trichoptere', condition: ['rapides', 'sable', 'galets'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'ephemeridae', 'ephemeridae.png', 2, { tolerance: 3, taille: 5, typeMacro: 'ephemeroptere', condition: ['sable'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'prosobranchia', 'prosobranchia.png', 2, { tolerance: 8, taille: 5, typeMacro: 'mollusque', condition: [''], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'sphaeridae', 'sphaeridae.png', 2, { tolerance: 5, taille: 3, typeMacro: 'mollusque', condition: ['rapides', 'gravier'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'anisoptera', 'anisoptera.png', 3, { tolerance: 5, taille: 6, typeMacro: 'odonate', condition: ['rapides'], predateur: 1 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'glossosomatidae', 'glossosomatidae.png', 3, { tolerance: 0, taille: 5, typeMacro: 'trichoptere', condition: ['rapides', 'gravier', 'galets'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'heptageniidae', 'heptageniidae.png', 3, { tolerance: 2, taille: 4, typeMacro: 'ephemeroptere', condition: ['rapides', 'galets'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'ephemerellidae', 'ephemerellidae.png', 3, { tolerance: 1, taille: 4, typeMacro: 'ephemeroptere', condition: ['rapides', 'gravier'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'brachycentrus', 'brachycentrus.png', 3, { tolerance: 3, taille: 4, typeMacro: 'trichoptere', condition: ['rapides', 'galets'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'rhyacophilidae', 'rhyacophilidae.png', 4, { tolerance: 0, taille: 4, typeMacro: 'trichoptere', condition: ['rapides'], predateur: 1 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'tipulidae', 'tipulidae.png', 4, { tolerance: 3, taille: 8, typeMacro: 'diptere', condition: ['fosse'], predateur: 0 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'gyrinidae', 'gyrinidae.png', 4, { tolerance: 4, taille: 5, typeMacro: 'coleoptere', condition: ['fosse'], predateur: 1 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'perlidae', 'perlidae.png', 4, { tolerance: 1, taille: 5, typeMacro: 'plecoptere', condition: ['rapides', 'gravier', 'galets'], predateur: 1 });
            paquetCarte.push(carte)
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'corydalidae', 'corydalidae.png', 5, { tolerance: 0, taille: 8, typeMacro: 'megaloptere', condition: ['rapides', 'gravier', 'galets'], predateur: 1 });
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'nepidae', 'nepidae.png', 6, { tolerance: 6, taille: 9, typeMacro: 'hemiptere', condition: ['fosse'], predateur: 1 });
            paquetCarte.push(carte)

            carte = new Carte('macroInvertebre', 'decapoda', 'decapoda.png', 6, { tolerance: 5, taille: 10, typeMacro: 'crustace', condition: ['galets'], predateur: 0 });
            paquetCarte.push(carte);

            carte = new Carte('macroInvertebre', 'pteronarcyidae', 'pteronarcyidae.png', 7, { tolerance: 0, taille: 8, typeMacro: 'plecoptere', condition: ['rapides', 'gravier', 'galets'], predateur: 0 });
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            //}

            //if (tour == 5) {
            //---------------------------------salmonide---------------------------------

            carte = new Carte('salmonide', 'ombleFontaine', 'ombleFontaine.png', 10, { tolerance: 4, condition: ['fosse', 'rapides', 'gravier', 'galets'], predateur: 2 });
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            //---------------------------------bandeRiveraine----------------------------

            carte = new Carte('bandeRiveraine', 'herbaceesNaturelles', 'herbaceesNaturelles.png', 1);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            carte = new Carte('bandeRiveraine', 'arbustes', 'arbustes.png', 2);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);

            carte = new Carte('bandeRiveraine', 'arbres', 'arbres.png', 3);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            paquetCarte.push(carte);
            //}
            if (difficulte === 2)//Moyen
            {

                //---------------------------action--------------------------------------

                carte = new Carte('action', 'corveNettoyage', 'corveNettoyage.png', 1);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('action', 'naturalisation', 'naturalisation.png', 2);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('action', 'amenagement', 'amenagement.png', 3);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                //--------------------------perturbation--------------------------------------

                carte = new Carte('perturbation', 'dechets', 'dechets.png', 2, { tempsActif: 0 });
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('perturbation', 'erosion', 'erosion.png', 3, { tempsActif: 0 });
                paquetCarte.push(carte);

                carte = new Carte('perturbation', 'passageToutTerrain', 'passageToutTerrain.png', 3, { tempsActif: 1 });
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('perturbation', 'artificialisation', 'artificialisation.png', 3, { tempsActif: 0 });
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('perturbation', 'pollutionOrganique', 'pollutionOrganique.png', 4, { tempsActif: 2 });
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('perturbation', 'deversement', 'deversement.png', 2, { tempsActif: 1 });
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                //--------------------------------reglementation----------------------------------------------

                carte = new Carte('reglementation', 'assainissement', 'assainissement.png', 3);
                paquetCarte.push(carte);

                carte = new Carte('reglementation', 'interdiction', 'interdiction.png', 3);
                paquetCarte.push(carte);

                carte = new Carte('reglementation', 'politique', 'politique.png', 3);
                paquetCarte.push(carte);

                //---------------------------------intervention------------------------------

                carte = new Carte('intervention', 'habitatAmenageSable', 'habitatAmenageSable.png', 1, { habitats: 'sable' });
                paquetCarte.push(carte);

                carte = new Carte('intervention', 'habitatAmenageRapides', 'habitatAmenageRapides.png', 1, { habitats: 'rapides' });
                paquetCarte.push(carte);

                carte = new Carte('intervention', 'habitatAmenageFosse', 'habitatAmenageFosse.png', 1, { habitats: 'fosse' });
                paquetCarte.push(carte);

                carte = new Carte('intervention', 'habitatAmenageGalets', 'habitatAmenageGalets.png', 1, { habitats: 'galets' });
                paquetCarte.push(carte);

                carte = new Carte('intervention', 'habitatAmenageGravier', 'habitatAmenageGravier.png', 1, { habitats: 'gravier' });
                paquetCarte.push(carte);

                carte = new Carte('intervention', 'bandeRiveraineHerbace', 'bandeRiveraineHerbace.png', 1);
                paquetCarte.push(carte);

                carte = new Carte('intervention', 'bandeRiveraineArbuste', 'bandeRiveraineArbuste.png', 2);
                paquetCarte.push(carte);

                carte = new Carte('intervention', 'bandeRiveraineArbre', 'bandeRiveraineArbre.png', 3);
                paquetCarte.push(carte);
            }

            if (difficulte >= 3)//Difficile
            {
                //-----------------------------------speciale--------------------------------

                carte = new Carte('speciale', 'prisSurFait', 'prisSurFait.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('speciale', 'pecheur', 'pecheur.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('speciale', 'crueSoudaine', 'crueSoudaine.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('speciale', 'zonage', 'zonage.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('speciale', 'retention', 'retention.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('speciale', 'emergence', 'emergence.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('speciale', 'derivation', 'derivation.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('speciale', 'accumulation', 'accumulation.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);

                carte = new Carte('speciale', 'predation', 'predation.png', 0);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
                paquetCarte.push(carte);
            }
            return paquetCarte;
        }

        //Fonction appellé lors d'un clic sur le boutton Passer son tour
        function passerTour() {
            facteurRotation += 1;
            if (facteurRotation > 4) {
                facteurRotation = 1;
            }
            var angleRotationDebut = (90 * (facteurRotation - 1));
            var angleRotationFin = (90 * facteurRotation);
            var $plateau = $('#plateau');
            $({ deg: angleRotationDebut }).animate({ deg: angleRotationFin }, {
                duration: 1000,
                step: function (now) {
                    $plateau.css('-webkit-transform', 'rotate(' + now + 'deg)');
                    $plateau.css('-moz-transform', 'rotate(' + now + 'deg)');
                    $plateau.css('transform', 'rotate(' + now + 'deg)');
                }
            });

            //var plateau = document.getElementById('plateau');

            //plateau.style.animation = 'transform: rotate(' + angleRotation + 'deg';
            numeroJoueurActif++;
            if (numeroJoueurActif === 4) {
                numeroJoueurActif = 0;
            }
            updateJeu();
        }

        //Fonction qui "update" le jeu.
        function updateJeu() {
            //Afficher les cartes selon le tableau main[]
            for (i = 0; i < 6; i++) {
                carteMain = document.getElementById('divCarte' + i)
                if (carteMain.children.length === 0) {
                    if (mains[numeroJoueurActif][i] != null) {
                        var image = document.createElement('img');
                        image.className = 'imageCarte';
                        image.src = 'ressources/' + mains[numeroJoueurActif][i].nomImage;
                        carteMain.appendChild(image);
                        $(function () {
                            $('.imageCarte').draggable({ revert: 'invalid', cursorAt: { top: 90, left: 59 } });
                        });
                    }
                }
                else {
                    carteMain.removeChild(carteMain.firstChild);

                    if (mains[numeroJoueurActif][i] != null) {
                        var image = document.createElement('img');
                        image.className = 'imageCarte';
                        image.src = 'ressources/' + mains[numeroJoueurActif][i].nomImage;
                        carteMain.appendChild(image);
                        $(function () {
                            $('.imageCarte').draggable({ revert: 'invalid', cursorAt: { top: 90, left: 59 } });
                        });
                    }
                }
            }
        }
    </script>
</body>
</html>